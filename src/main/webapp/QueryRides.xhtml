<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml"
      xmlns:h="http://xmlns.jcp.org/jsf/html"
      xmlns:f="http://xmlns.jcp.org/jsf/core"
      xmlns:p="http://primefaces.org/ui">

<h:head>
    <title>Rides Bilatu</title>
    <h:outputStylesheet library="css" name="ultra.css" />
</h:head>

<h:body class="body-bg">

    <div class="glow"></div>

    <div class="layout-container scroll-area">

        <!-- Header -->
        <div class="main-header">
            <div class="logo-small">R</div>
            <h1 class="app-title">Rides Bilatu</h1>
        </div>

        <h:form styleClass="form">

            <div class="card page-columns">

                <!-- Izquierda: Formularioa + Calendar -->
                <div>
                    <!-- CIUDAD DE SALIDA -->
                    <div class="field">
                        <label for="cityCombo">Irteera hiri:</label>
                        <h:selectOneMenu id="cityCombo" value="#{qrBean.selectedCity}" styleClass="input">
                            <f:selectItem itemLabel="-----Aukeratu irteera hiria-----" itemValue="" />
                            <f:selectItems value="#{qrBean.cities}" />
                            <f:ajax listener="#{qrBean.updateArrivalCities}" render="cityCombo2" />
                        </h:selectOneMenu>
                    </div>

                    <!-- CIUDAD DE DESTINO -->
                    <div class="field">
                        <label for="cityCombo2">Helmuga hiri:</label>
                        <h:selectOneMenu id="cityCombo2" value="#{qrBean.selectedCity2}" styleClass="input">
                            <f:selectItem itemLabel="-----Aukeratu helmuga hiria-----" itemValue="" />
                            <f:selectItems value="#{qrBean.cities2}" />
                        </h:selectOneMenu>
                    </div>

                    <!-- FECHA -->
				<div class="field calendar-container">
				    <label for="data">Data:</label>
				    <p:calendar id="data" value="#{qrBean.selectedDate}" navigator="false" mode="popup" style="width:100%">
				        <!-- Cuando cambie la fecha, ejecuta findRides y actualiza todo el formulario -->
				        <p:ajax event="dateSelect" listener="#{qrBean.findRides}" update="@form" />
				    </p:calendar>
				</div>


                    <!-- BOTÃ“N BUSCAR -->
                    <div class="field">
                        <h:commandButton value="Bilatu rides" action="#{qrBean.findRides}" styleClass="btn btn-primary" update="@form"/>
                    </div>
                </div>

                <!-- Derecha: Tabla de rides -->
                <div>
                    <p:dataTable id="ridesTable" value="#{qrBean.availableRides}" var="r" styleClass="rides-table" emptyMessage="Ez dago bidairik" style="width:100%">
                        <p:column headerText="Nontik">#{r.from}</p:column>
                        <p:column headerText="Nora">#{r.to}</p:column>
                        <p:column headerText="Data">#{r.date}</p:column>
                        <p:column headerText="Prezioa">#{r.price}</p:column>
                    </p:dataTable>

                    <h:commandButton value="Itxi" action="back" styleClass="btn btn-secondary" style="margin-top:10px; width:100%" />
                </div>

            </div>

        </h:form>

    </div>

</h:body>
</html>
